<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문제집 답지 공유 플랫폼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
    </style>
</head>
<body class="bg-gray-100">
    <header class="bg-indigo-500 text-white py-4">
        <div class="container mx-auto px-4">
            <h1 class="text-3xl font-semibold">문제집 답지 공유 플랫폼</h1>
            <p class="text-lg">함께 답을 공유하고, 함께 성장하세요!</p>
        </div>
    </header>

    <main class="container mx-auto py-6 px-4">
        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">답지 검색</h2>
            <div class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="search-box" placeholder="문제집 이름 또는 과목을 입력하세요..." class="border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <button id="search-button" class="bg-indigo-500 hover:bg-indigo-600 text-white rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition-colors duration-300">검색</button>
            </div>
        </section>

        <section class="bg-white rounded-lg shadow-md p-6 mb-8">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">답지 업로드</h2>
            <p class="text-gray-600 mb-4">가지고 있는 문제집 답안을 공유해주세요!</p>
            <div class="flex flex-col sm:flex-row gap-4">
                <input type="text" id="upload-book-name" placeholder="문제집 이름" class="border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <input type="text" id="upload-subject" placeholder="과목" class="border border-gray-300 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                <input type="file" id="upload-file" class="mb-4 sm:mb-0">
                <button id="upload-button" class="bg-green-500 hover:bg-green-600 text-white rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors duration-300">업로드</button>
            </div>
            <p id="upload-message" class="mt-4 text-gray-700"></p>
        </section>

        <section id="results-container" class="bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold text-gray-800 mb-4">검색 결과</h2>
            <ul id="results-list" class="space-y-3">
                </ul>
            <p id="no-results-message" class="text-gray-500" style="display: none;">검색 결과가 없습니다.</p>
        </section>
    </main>

    <footer class="bg-gray-200 text-gray-700 py-4 mt-8">
        <div class="container mx-auto px-4 text-center">
            &copy; 2024 문제집 답지 공유 플랫폼. All rights reserved.
        </div>
    </footer>

    <script>
        const searchBox = document.getElementById('search-box');
        const searchButton = document.getElementById('search-button');
        const uploadBookNameInput = document.getElementById('upload-book-name');
        const uploadSubjectInput = document.getElementById('upload-subject');
        const uploadFileInput = document.getElementById('upload-file');
        const uploadButton = document.getElementById('upload-button');
        const uploadMessage = document.getElementById('upload-message');
        const resultsList = document.getElementById('results-list');
        const noResultsMessage = document.getElementById('no-results-message');
        const resultsContainer = document.getElementById('results-container');

        let answerKeys = [
            { bookName: "수학의 정석", subject: "수학", file: "math1.pdf" },
            { bookName: "쎈 수학", subject: "수학", file: "math2.pdf" },
            { bookName: "자이스토리", subject: "영어", file: "english1.pdf" },
            { bookName: "EBS 수능특강", subject: "영어", file: "english2.pdf" },
            { bookName: "개념원리", subject: "수학", file: "math3.pdf" },
        ];

        searchButton.addEventListener('click', () => {
            const searchTerm = searchBox.value.toLowerCase();
            const filteredAnswerKeys = answerKeys.filter(answerKey =>
                answerKey.bookName.toLowerCase().includes(searchTerm) ||
                answerKey.subject.toLowerCase().includes(searchTerm)
            );

            resultsList.innerHTML = ''; // Clear previous results
            if (filteredAnswerKeys.length === 0) {
                noResultsMessage.style.display = 'block';
                resultsContainer.style.display = 'none'; // Hide the results container
            } else {
                noResultsMessage.style.display = 'none';
                resultsContainer.style.display = 'block'; // Show the results container
                filteredAnswerKeys.forEach(answerKey => {
                    const listItem = document.createElement('li');
                    listItem.className = "bg-white rounded-md shadow-sm py-2 px-3 flex justify-between items-center";
                    listItem.innerHTML = `
                        <div>
                            <h3 class="font-semibold text-gray-800">${answerKey.bookName}</h3>
                            <p class="text-gray-600 text-sm">${answerKey.subject}</p>
                        </div>
                        <a href="${answerKey.file}" download class="bg-blue-500 hover:bg-blue-600 text-white rounded-md py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-300">
                            다운로드
                        </a>
                    `;
                    resultsList.appendChild(listItem);
                });
            }
        });

        uploadButton.addEventListener('click', () => {
            const bookName = uploadBookNameInput.value.trim();
            const subject = uploadSubjectInput.value.trim();
            const file = uploadFileInput.files[0];

            if (!bookName || !subject || !file) {
                uploadMessage.textContent = "모든 필드를 입력해주세요.";
                uploadMessage.style.color = "red";
                return;
            }

            // 파일 형식 검사 (PDF만 허용)
            if (file.type !== "application/pdf") {
                uploadMessage.textContent = "PDF 파일만 업로드 가능합니다.";
                uploadMessage.style.color = "red";
                return;
            }

            // 파일 크기 검사 (5MB 제한)
            if (file.size > 5 * 1024 * 1024) {
                uploadMessage.textContent = "파일 크기는 5MB 이하여야 합니다.";
                uploadMessage.style.color = "red";
                return;
            }

            // 파일 이름을 안전하게 처리 (예시: 날짜+이름)
            const newFileName = `${new Date().toISOString()}-${file.name}`;

            // 여기서는 파일을 서버에 저장하는 대신, 클라이언트 메모리에 임시로 저장합니다.
            const newAnswerKey = {
                bookName: bookName,
                subject: subject,
                file: URL.createObjectURL(file), // Use createObjectURL for local preview
                fileName: newFileName, // Store the safe file name
            };

            answerKeys.push(newAnswerKey);
            console.log("Uploaded:", newAnswerKey); // Log the uploaded file info

            uploadMessage.textContent = "답안이 성공적으로 업로드되었습니다.";
            uploadMessage.style.color = "green";
            uploadBookNameInput.value = '';
            uploadSubjectInput.value = '';
            uploadFileInput.value = ''; // Clear the file input
        });
    </script>
</body>
</html>
